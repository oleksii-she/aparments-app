import{_ as R,ab as $,b as L,ac as F,d as x,u as j,r as U,q as z,e as I,o,c as r,a as e,t as d,h as S,m as l,y as T,f as y,v as V,x as C,g as G,ad as H,ae as J,j as K,af as M,ag as P,ah as O,p as Q,k as W,A as X,l as A}from"./index-a1285de2.js";const h=m=>(Q("data-v-0df187d4"),m=m(),W(),m),N=A+"#icon-edit",q=A+"#icon-confirm",Y={class:"container user-page"},Z={class:"home-page__wrapper"},ee={class:"user-wrapper"},te={key:0,class:"user"},se={class:"wrapper"},ae={key:0,class:"user__text-wrapper"},ne={class:"user__text"},oe=h(()=>e("svg",{class:"btn-edit__icon"},[e("use",{"xlink:href":N})],-1)),re=[oe],ce={key:1,class:"user__text-wrapper"},ie={class:"user__text"},_e=["value"],le=h(()=>e("svg",{class:"btn-edit__icon"},[e("use",{"xlink:href":q})],-1)),ue=[le],pe={class:"user__text-wrapper"},de={class:"user__text"},he={class:"wrapper"},me={key:0,class:"user__text-wrapper"},ve={key:0,class:"user__text"},ge={key:1,class:"user__text"},fe=h(()=>e("svg",{class:"btn-edit__icon"},[e("use",{"xlink:href":N})],-1)),xe=[fe],ye={key:1,class:"user__text-wrapper"},ke={class:"user__text"},we=["value"],be=h(()=>e("svg",{class:"btn-edit__icon"},[e("use",{"xlink:href":q})],-1)),Ue=[be],Ie={key:1,class:"user"},Se={class:"wrapper"},Ve={class:"user__text-wrapper"},Ce={class:"user__text"},Pe={class:"user__text-wrapper"},Ae={class:"user__text"},Ne={class:"user__text-wrapper"},qe={class:"user__text"},Ee={class:"user-rating-box"},Be=h(()=>e("h3",null,"User rating",-1)),De={__name:"UserPage",setup(m){const g=$(),E=L(),B=9,c=F(),p=x(parseInt(g.query.page)||1),u=j(),D=X({position:"top"}),i=U({name:!1,phone:!1}),n=U({name:"",phone:""}),v=x({}),k=x(null);z(async()=>{const{id:a}=u;E.push({query:{...g.query,page:p.value}});const t=g.params.id;if(t){await c.fetchUserApartments(t,p.value);const{user:_,phone:f,email:s}=c.apartments[0].user;v.value={user:_,phone:f,email:s},k.value=t}else c.fetchUserApartments(a,p.value);if(n.name=u.name,u.phone){const _=P(u.phone);n.phone=_}});const w=a=>{if(a.target.name==="name"&&(n.name=a.target.value),a.target.name==="phone"){const t=a.target.value;/^\+38\(\d{3}\)\d{3}-\d{2}-\d{2}$/.test(t)&&(n.phone=a.target.value)}},b=async()=>{try{const a=K(n.phone),t=n.name,_={phone:a,name:t};await u.fetchUpdateUser(_),i.phone=!1,i.name=!1}catch(a){if(i.phone=!1,i.name=!1,a.request.status===400)return n.phone=u.phone,D.warning(a.request.response);console.log(a.message)}};return(a,t)=>{const _=I("URating"),f=I("ULoader");return o(),r("main",null,[e("section",null,[e("div",Y,[e("div",Z,[e("div",ee,[k.value?(o(),r("div",Ie,[e("div",Se,[e("div",Ve,[e("p",Ce,"Name: "+d(v.value.user),1)]),e("div",Pe,[e("p",Ae,"Email: "+d(v.value.email),1)]),e("div",Ne,[e("p",qe,"Phone: "+d(l(P)(v.value.phone)),1)])])])):(o(),r("div",te,[e("div",se,[i.name?(o(),r("div",ce,[e("label",ie,[S(" і’мя: "),e("input",{class:"user__input-rename",name:"name",value:n.name,onChange:w},null,40,_e)]),e("button",{onClick:b,class:"btn-edit"},ue)])):(o(),r("div",ae,[e("p",ne,"і’мя: "+d(n.name),1),e("button",{onClick:t[0]||(t[0]=s=>i.name=!0),class:"btn-edit"},re)]))]),e("div",pe,[e("p",de,"E-mail: "+d(l(u).email),1)]),e("div",he,[i.phone?(o(),r("div",ye,[e("label",ke,[S(" Телефон: "),T(e("input",{ref:"phoneInput",class:"user__input-rename",type:"tel",name:"phone",value:n.phone,onChange:w},null,40,we),[[l(M),{mask:"+38(0##)###-##-##"}]])]),e("button",{onClick:b,class:"btn-edit"},Ue)])):(o(),r("div",me,[n.phone?(o(),r("p",ve,"Телефон: "+d(n.phone),1)):(o(),r("p",ge,"Телефон: +38(000)000-00-00")),e("button",{onClick:t[1]||(t[1]=s=>i.phone=!0),class:"btn-edit"},xe)]))])])),e("div",Ee,[Be,y(_,{width:50,height:50})])]),e("div",null,[l(c).loading?(o(),V(f,{key:0,loading:!0})):C("",!0),y(H,{apartments:l(c).apartments},{apartment:G(s=>[y(O,{id:s.apartment._id,coverImage:s.apartment.coverImage,description:s.apartment.description,price:s.apartment.price,longStayPrice:s.apartment.longStayPrice,country:s.apartment.country,rating:s.apartment.rating},null,8,["id","coverImage","description","price","longStayPrice","country","rating"])]),_:1},8,["apartments"])])]),l(c).totalPosts>9&&!l(c).loading?(o(),V(J,{key:0,class:"paginate",modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=s=>p.value=s),perPage:B,rangeSize:1,"active-color":"#DCEDFF","onUpdate:value":t[3]||(t[3]=s=>p.value=s),totalPost:l(c).totalPosts},null,8,["modelValue","totalPost"])):C("",!0)])])])}}},$e=R(De,[["__scopeId","data-v-0df187d4"]]);export{$e as default};
