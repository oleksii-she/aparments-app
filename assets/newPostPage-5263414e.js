import{S as se,C as oe}from"./containerAuth-04bd9afa.js";import{_ as ae,r as E,k as ne,b as ie,d as C,l as O,e as F,o as c,c as r,f as d,a as t,g,n as le,v as ce,F as S,q as A,t as re,s as y,x as H,h as de,i as ue,y as pe,z as _e,p as me,j as ge,A as ve,B}from"./index-79db5f85.js";let b;const he=new Uint8Array(16);function fe(){if(!b&&(b=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!b))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return b(he)}const i=[];for(let s=0;s<256;++s)i.push((s+256).toString(16).slice(1));function ye(s,e=0){return(i[s[e+0]]+i[s[e+1]]+i[s[e+2]]+i[s[e+3]]+"-"+i[s[e+4]]+i[s[e+5]]+"-"+i[s[e+6]]+i[s[e+7]]+"-"+i[s[e+8]]+i[s[e+9]]+"-"+i[s[e+10]]+i[s[e+11]]+i[s[e+12]]+i[s[e+13]]+i[s[e+14]]+i[s[e+15]]).toLowerCase()}const Ve=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),M={randomUUID:Ve};function Ie(s,e,f){if(M.randomUUID&&!e&&!s)return M.randomUUID();s=s||{};const v=s.random||(s.rng||fe)();if(v[6]=v[6]&15|64,v[8]=v[8]&63|128,e){f=f||0;for(let h=0;h<16;++h)e[f+h]=v[h];return e}return ye(v)}const l=s=>(me("data-v-a2ffd447"),s=s(),ge(),s),T=B+"#icon-cancel-circle",q=B+"#icon-create__img",Ue=B+"#icon-camera",we=["onSubmit"],ke=l(()=>t("h2",{class:"title__form-create"},"Створити оголошення",-1)),xe={class:"top__wrapper"},Ce=l(()=>t("p",{class:"title-input"},"Назва оголошення",-1)),Se=l(()=>t("p",{class:"title-input"},"Країна",-1)),be={key:0,class:"countries-list"},Pe=["onClick"],De={class:"countries-list__text"},Le=l(()=>t("p",{class:"title-input"},"Місто",-1)),Fe={class:"average__wrapper"},Ae={class:"main__photo"},Be=l(()=>t("h3",{style:{marginBottom:"7px"}},"Головне фото",-1)),Re={for:"",class:"cover-img__wrapper"},Ne=l(()=>t("svg",{class:"clear-img__icon"},[t("use",{"xlink:href":T})],-1)),$e=[Ne],je={class:"img__box"},Ee=["src"],Oe={key:1,class:"icon"},He=l(()=>t("use",{"xlink:href":q},null,-1)),Me=[He],Te={class:"input-block__right"},qe={class:"input-wrapper"},ze=l(()=>t("p",{class:"title-input"},"Кількість кімнат",-1)),Ye=l(()=>t("p",{class:"title-input"},"Адреса",-1)),Ge={class:"price"},Je=l(()=>t("p",{class:"title-input"},"ціна за ніч",-1)),Ke={class:"price__wrapper"},Qe=l(()=>t("h2",{class:"price__title"},"$",-1)),We={class:"price"},Xe=l(()=>t("p",{class:"title-input"},"ціна від трьох ночей",-1)),Ze={class:"price__wrapper"},et=l(()=>t("h2",{class:"price__title"},"$",-1)),tt=l(()=>t("p",{class:"title-input"},"Опишіть апартаменти",-1)),st=pe('<div data-v-a2ffd447><p class="title-input" data-v-a2ffd447>Клас апартаментів</p><select name="select" class="select" data-v-a2ffd447><option value="Economy" data-v-a2ffd447>Economy</option><option value="Comfort" selected data-v-a2ffd447>Comfort</option><option value="Business" data-v-a2ffd447>Business</option><option value="Premium" data-v-a2ffd447>Premium</option><option value="Lux" data-v-a2ffd447>Lux</option></select></div>',1),ot={class:"bottom-wrapper"},at={key:0,for:"",class:"img__file-wrapper"},nt={key:0,class:"icon"},it=l(()=>t("use",{"xlink:href":q},null,-1)),lt=[it],ct=l(()=>t("svg",{class:""},[t("use",{"xlink:href":Ue})],-1)),rt=[ct],dt=["src"],ut=["onClick"],pt=l(()=>t("svg",{class:"clear-img__icon"},[t("use",{"xlink:href":T})],-1)),_t=[pt],mt={__name:"createPost",setup(s){const e=E({name:"",location:"",country:"",address:"",rooms:1,price:40,longStayPrice:30,description:"",images:[],coverImage:"",apartmentClass:""}),f=ne(),v=ie(),h=ve({position:"top"}),P=C(!1),V=C(null),w=C(!0),R=C(null),z=async()=>{try{const n=await _e(e.country);!n||n===null?(w.value=!1,V.value=""):(w.value=!0,V.value=n)}catch(n){console.log(n.message)}},Y=n=>{w.value=!1,e.country=n,V.value=null},N=["../assets/svg/sprite.svg#icon-cancel-circle","@/assets/svg/sprite.svg#icon-create__img","@/assets/svg/sprite.svg#icon-create__img","@/assets/svg/sprite.svg#icon-create__img","@/assets/svg/sprite.svg#icon-create__img"],D=E([...N]),G=O(()=>e.coverImage?URL.createObjectURL(e.coverImage):null),J=O(()=>e.images?e.images.map(n=>{if(!(e.images.length>6))return{id:n.id,path:URL.createObjectURL(n.file),name:n.name}}):null),K=n=>{const o=n.target.files[0];o&&(e.coverImage=o)},Q=n=>{const o=n.target.files[0];new FormData().append("image",o),!(!o||e.images.length>5)&&o&&(D.splice(0,1),e.images.push({id:Ie(),file:o}))},W=()=>{e.coverImage&&(e.coverImage=null)},X=n=>{e.images=e.images.filter(o=>o.id!==n),e.images.length!==5&&D.push(N[0])},Z=()=>{const n=R.value;n&&n.click()},ee=async n=>{const{name:o,location:I,country:p,address:k,rooms:a,price:U,longStayPrice:L,description:$,images:te,coverImage:j}=e,x=te.map(m=>m.file),_={coverImage:j,images:x,apartmentClass:n.target.select.value,name:o,location:I,country:p,address:k,rooms:Number(a),price:Number(U),longStayPrice:Number(L),description:$};console.log(_);const u=new FormData;u.append("apartmentClass",_.apartmentClass);for(let m=0;m<x.length;m++)u.append("images",x[m],x[m].name);if(u.append("coverImage",_.coverImage),u.append("name",_.name),u.append("location",_.location),u.append("country",_.country),u.append("address",_.address),u.append("rooms",_.rooms),u.append("price",_.price),u.append("longStayPrice",_.longStayPrice),u.append("description",_.description),!o||!I||!p||!k||!a||!U||!L||!$||!j)return h.warning("Make sure all fields are filled");try{return P.value=!0,await f.addApartmentPost(u),P.value=!1,v.push({name:"home"}),h.success("data successfully added")}catch(m){return console.log(m.message),h.error(m.message)}};return(n,o)=>{const I=F("ULoader"),p=F("UInput"),k=F("UButton");return c(),r(S,null,[d(I,{loading:P.value},null,8,["loading"]),t("form",{onSubmit:ue(ee,["prevent","stop"]),class:"form__advertisement"},[ke,t("div",xe,[d(p,{modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.name=a),placeholder:"Назва оголошення",class:"uinput"},{default:g(()=>[Ce]),_:1},8,["modelValue"]),t("div",null,[d(p,{modelValue:e.country,"onUpdate:modelValue":o[1]||(o[1]=a=>e.country=a),placeholder:"Країна",class:"uinput",onInput:z},{default:g(()=>[Se]),_:1},8,["modelValue"]),V.value!==null?le((c(),r("ul",be,[(c(!0),r(S,null,A(V.value,(a,U)=>(c(),r("li",{key:U,class:"countries-list__item",onClick:L=>Y(a.name.common)},[t("p",De,re(a.name.common),1)],8,Pe))),128))],512)),[[ce,w.value]]):y("",!0)]),d(p,{modelValue:e.location,"onUpdate:modelValue":o[2]||(o[2]=a=>e.location=a),placeholder:"Місто",class:"uinput"},{default:g(()=>[Le]),_:1},8,["modelValue"])]),t("div",Fe,[t("div",Ae,[Be,t("label",Re,[e.coverImage?(c(),r("button",{key:0,class:"clear-img",onClick:W},$e)):y("",!0),t("div",je,[e.coverImage?(c(),r("img",{key:0,src:H(G),alt:"",class:"image"},null,8,Ee)):y("",!0)]),e.coverImage?y("",!0):(c(),r("svg",Oe,Me)),t("input",{type:"file",name:"coverImage",accept:"image/*",class:"input__file__hidden",multiple:"",onChange:K},null,32)])]),t("div",Te,[t("div",qe,[d(p,{modelValue:e.rooms,"onUpdate:modelValue":o[3]||(o[3]=a=>e.rooms=a),placeholder:"Кількість кімнат",class:"uinput",type:"number"},{default:g(()=>[ze]),_:1},8,["modelValue"]),d(p,{modelValue:e.address,"onUpdate:modelValue":o[4]||(o[4]=a=>e.address=a),placeholder:"Адреса",class:"uinput"},{default:g(()=>[Ye]),_:1},8,["modelValue"]),t("div",Ge,[Je,t("div",Ke,[Qe,d(p,{modelValue:e.price,"onUpdate:modelValue":o[5]||(o[5]=a=>e.price=a),placeholder:"ціна за ніч",class:"uinput",type:"number"},null,8,["modelValue"])])]),t("div",We,[Xe,t("div",Ze,[et,d(p,{modelValue:e.longStayPrice,"onUpdate:modelValue":o[6]||(o[6]=a=>e.longStayPrice=a),placeholder:"ціна від трьох ночей",class:"uinput",type:"number",style:{width:"70px"}},null,8,["modelValue"])])])]),d(p,{modelValue:e.description,"onUpdate:modelValue":o[7]||(o[7]=a=>e.description=a),placeholder:"Опишіть апартаменти",type:"textarea",class:"uinput"},{default:g(()=>[tt]),_:1},8,["modelValue"]),st])]),t("div",ot,[e.images.length!==6?(c(),r("label",at,[e.images?(c(),r("svg",nt,lt)):y("",!0),t("input",{type:"file",name:"images",accept:"image/*",class:"input__file__hidden",onChange:Q,ref_key:"input",ref:R},null,544)])):y("",!0),(c(!0),r(S,null,A(D,a=>(c(),r("div",{key:a},[t("div",{class:"img__file-wrapper",onClick:Z},rt)]))),128)),(c(!0),r(S,null,A(H(J),a=>(c(),r("div",{key:a.id,class:"img__box"},[t("img",{src:a.path,alt:"",class:"images"},null,8,dt),t("button",{onClick:U=>X(a.id),class:"clear-img"},_t,8,ut)]))),128))]),d(k,null,{default:g(()=>[de("Створити оголошення")]),_:1})],40,we)],64)}}},gt=ae(mt,[["__scopeId","data-v-a2ffd447"]]),ft={__name:"newPostPage",setup(s){return(e,f)=>(c(),r("main",null,[d(se,null,{default:g(()=>[d(oe,{class:"container"},{default:g(()=>[d(gt)]),_:1})]),_:1})]))}};export{ft as default};
