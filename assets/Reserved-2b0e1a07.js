import{_ as F,ab as H,b as V,d as h,q as T,o as r,c as o,a as e,F as z,B as O,E as q,Q as j,t as i,x as k,a8 as C,e as P,v as Q,g as m,p as J,k as K,l as U,a7 as W,n as X,ai as Y,aj as Z,f as v,m as l,ak as B,h as M,y as S}from"./index-9e60cacd.js";const ee={class:"wrapper"},se={class:"reserve-list"},te=["onClick"],re={class:"reserve__top"},oe={class:"reserve__title"},ne={key:0},ae={class:"reserve__description"},de={__name:"reserveMessageList",props:{reserves:Array,handlerIdGet:{type:Function,default:()=>{}}},setup(t){const g=t,f=H(),s=V(),I=h(null);T(()=>{I.value=f.params.id});const _=a=>{const u=C(),d=C(a);return d.isSame(u,"day")?d.format("HH:mm:ss"):d.format("MM.DD")},p=a=>{g.handlerIdGet(a),s.push(`/myaccount/reserved/${a}`)};return(a,u)=>(r(),o("div",ee,[e("ul",se,[(r(!0),o(z,null,O(t.reserves,d=>(r(),o("li",{class:"reserve-list__item",key:d._id},[e("div",{class:j(["reserve",{"reserve-active":I.value===d._id}]),onClick:L=>p(d._id)},[e("div",re,[e("p",oe,i(d.name),1),e("p",null,i(_(d.updatedAt)),1)]),d.apartmentName?(r(),o("p",ne,i(d.apartmentName),1)):k("",!0),e("p",ae,i(d.description),1)],10,te)]))),128)),q(a.$slots,"default",{},void 0,!0)])]))}},D=F(de,[["__scopeId","data-v-f80bb944"]]);const A=t=>(J("data-v-66262a9a"),t=t(),K(),t),le=U+"#icon-reserved",ie=U+"#icon-delete",ce={key:0,class:"wrapper-info"},ve={class:"header"},_e={class:"info"},ue={class:"info__header-text"},fe={class:"info__email-link",href:"mailto:{{ reserveInfo.email }}"},he={class:"button-box"},pe=A(()=>e("use",{"xlink:href":le},null,-1)),me=[pe],ge=A(()=>e("button",{type:"",class:"button"},[e("svg",{class:"button__icon"},[e("use",{"xlink:href":ie})])],-1)),Ie=["src"],ye={class:"price-date"},ke={class:"price-date__text"},$e={class:"price-date__text"},be={class:"price-date__text"},xe={class:"price-date__text"},Re={class:"description-box"},we={class:"description-box__date"},Me={class:"description-box__description"},Se={key:1,class:"wrapper-info-default"},De=A(()=>e("div",null,[e("h2",null,"Select a message to read it")],-1)),Te=[De],Ce={__name:"reserveMessageInfo",props:{reserveInfo:Object,updateReserve:{type:Function,default:()=>{}}},setup(t){const g=t,f=h(null);T(async()=>{if(g.reserveInfo&&typeof g.reserveInfo.reserved<"u"){const _=g.reserveInfo.reserved;f.value=_}});const s=_=>{const p=C(),a=C(_);return a.isSame(p,"day")?a.format("HH:mm:ss"):a.format("MM.DD")},I=_=>{f.value||(f.value=!0,g.updateReserve(_))};return(_,p)=>{const a=P("RouterLink");return t.reserveInfo?(r(),o("div",ce,[e("div",ve,[e("div",_e,[e("p",ue,"Name: "+i(t.reserveInfo.name),1),e("a",fe,i(t.reserveInfo.email),1)]),e("div",he,[e("button",{type:"",class:"button",onClick:p[0]||(p[0]=u=>I(t.reserveInfo.apartmentId))},[(r(),o("svg",{class:j(["button__icon-reserved",{"button__icon-reserved---active":f.value}])},me,2))]),ge])]),e("div",null,[t.reserveInfo.apartmentId?(r(),Q(a,{key:0,to:{name:"review-page",params:{id:t.reserveInfo.apartmentId}},class:"wrapper-info__apartment-link"},{default:m(()=>[e("img",{src:t.reserveInfo.coverImage,alt:"",width:"64"},null,8,Ie),e("p",null,i(t.reserveInfo.apartmentName),1)]),_:1},8,["to"])):k("",!0)]),e("div",null,[e("div",ye,[e("div",null,[e("p",ke,"sum: "+i(t.reserveInfo.sum)+"$",1),e("p",$e,"number of days: "+i(t.reserveInfo.numberOfDays),1)]),e("div",null,[e("p",be,"Start date: "+i(t.reserveInfo.startDate)+"$",1),e("p",xe,"End date: "+i(t.reserveInfo.endDate),1)])])]),e("div",Re,[e("p",we,i(s(t.reserveInfo.updatedAt)),1),e("p",Me,i(t.reserveInfo.description),1)])])):(r(),o("div",Se,Te))}}},E=F(Ce,[["__scopeId","data-v-66262a9a"]]);const Ge={class:"container"},Ae={key:0,class:"reserved-wrapper reserved-mobile"},Le={key:0},Ne={key:0,class:"reserved-box"},Be=e("h2",{style:{"text-align":"center","margin-bottom":"20px"}},"In reserve",-1),Ee={key:0},Fe={key:1,class:"reserved-box"},He=e("h2",{style:{"text-align":"center","margin-bottom":"20px"}},"Reserved",-1),je={key:0},Pe={key:1,class:"reserved-wrapper__info"},Ue={key:1,class:"reserved-wrapper"},Ve={key:0,class:"reserved-box"},ze=e("h2",null,"In reserve",-1),Oe={key:0},qe={key:1,class:"reserved-box"},Qe=e("h2",null,"Reserved",-1),Je={key:0},Ke={class:"reserved-wrapper__info"},Xe={__name:"Reserved",setup(t){const g=H(),{id:f}=g.params,s=W(),I=X(),_=h(null),p=h(!1),a=h(1);h(null);const u=h(!1),{isMobile:d}=Y(),L=h(null),G=h(!1);h(""),T(async()=>{await s.fetchGetAllReserve(),s.reserves.length!==s.totalReservePost&&await s.fetchGetAllReserve(a.value)}),T(async()=>{let c=_.value;c||(c=f),s.reserversIdInfo(c);const n=s.reservesReserved.find(y=>y._id===f);n&&(console.log("===================================="),console.log(n),console.log("===================================="),u.value=!0)});const $=()=>{p.value=!p.value},b=c=>{s.reserves<=9||c&&(s.reserves.length!==s.totalReservePost&&(a.value=1),console.log(c))},x=c=>{_.value=c,s.reserversIdInfo(f),c&&(G.value=!0)},N=async c=>{try{const n=await I.updateApartmentReserved(c,{reserved:!0});L.value=n.reserved,await s.fetchGetAllReserve()}catch(n){console.log(n.message)}};return(c,n)=>{const y=P("UButton"),R=Z("observe-visibility");return r(),o("div",Ge,[v(B,{loading:l(s).loading},null,8,["loading"]),l(d)?(r(),o("div",Ae,[G.value?(r(),o("div",Pe,[e("button",{onClick:n[2]||(n[2]=w=>G.value=!1)},"назад"),v(E,{reserveInfo:l(s).reserveId,updateReserve:N},null,8,["reserveInfo"])])):(r(),o("div",Le,[u.value?(r(),o("div",Ne,[v(y,{style:{width:"150px",height:"50px"},onClick:n[0]||(n[0]=w=>u.value=!1)},{default:m(()=>[M("Reserved")]),_:1}),Be,v(D,{reserves:l(s).reservesReserved,hideModalToggle:$,handlerIdGet:x},{default:m(()=>[l(s).reserves.length?S((r(),o("div",Ee,null,512)),[[R,b]]):k("",!0)]),_:1},8,["reserves"])])):(r(),o("div",Fe,[v(y,{style:{width:"150px",height:"50px"},onClick:n[1]||(n[1]=w=>u.value=!0)},{default:m(()=>[M("In reserve")]),_:1}),He,v(D,{reserves:l(s).reserves,hideModalToggle:$,handlerIdGet:x},{default:m(()=>[l(s).reserves.length?S((r(),o("div",je,null,512)),[[R,b]]):k("",!0)]),_:1},8,["reserves"])]))]))])):(r(),o("div",Ue,[u.value?(r(),o("div",Ve,[v(y,{style:{width:"250px"},onClick:n[3]||(n[3]=w=>u.value=!1)},{default:m(()=>[M("Reserved")]),_:1}),ze,v(D,{reserves:l(s).reservesReserved,hideModalToggle:$,handlerIdGet:x},{default:m(()=>[l(s).reserves.length>9?S((r(),o("div",Oe,null,512)),[[R,b]]):k("",!0)]),_:1},8,["reserves"])])):(r(),o("div",qe,[v(y,{style:{width:"250px"},onClick:n[4]||(n[4]=w=>u.value=!0)},{default:m(()=>[M("In reserve")]),_:1}),Qe,v(D,{reserves:l(s).reserves,hideModalToggle:$,handlerIdGet:x},{default:m(()=>[l(s).reserves.length>9?S((r(),o("div",Je,null,512)),[[R,b]]):k("",!0)]),_:1},8,["reserves"])])),v(B,{loading:l(s).loading},null,8,["loading"]),e("div",Ke,[v(E,{reserveInfo:l(s).reserveId,updateReserve:N},null,8,["reserveInfo"])])]))])}}};export{Xe as default};
