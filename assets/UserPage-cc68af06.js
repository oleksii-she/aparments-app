import{_ as L,ab as F,b as j,ac as z,d as x,u as M,r as U,q as T,e as I,o,c as r,a as e,t as d,h as S,m as l,y as G,f as y,v as V,x as C,g as H,ad as J,ae as K,j as O,af as Q,ag as P,ah as W,p as X,k as Y,A as Z,l as A}from"./index-6112acc6.js";const m=v=>(X("data-v-fdbf911d"),v=v(),Y(),v),N=A+"#icon-edit",q=A+"#icon-confirm",ee={class:"container user-page"},te={class:"home-page__wrapper"},se={class:"user-wrapper"},ae={key:0,class:"user"},ne={class:"wrapper"},oe={key:0,class:"user__text-wrapper"},re={class:"user__text"},ce=m(()=>e("svg",{class:"btn-edit__icon"},[e("use",{"xlink:href":N})],-1)),ie=[ce],_e={key:1,class:"user__text-wrapper"},le={class:"user__text"},ue=["value"],pe=m(()=>e("svg",{class:"btn-edit__icon"},[e("use",{"xlink:href":q})],-1)),de=[pe],he={class:"user__text-wrapper"},me={class:"user__text"},ve={class:"wrapper"},ge={key:0,class:"user__text-wrapper"},fe={key:0,class:"user__text"},xe={key:1,class:"user__text"},ye=m(()=>e("svg",{class:"btn-edit__icon"},[e("use",{"xlink:href":N})],-1)),be=[ye],ke={key:1,class:"user__text-wrapper"},we={class:"user__text"},Ue=["value"],Ie=m(()=>e("svg",{class:"btn-edit__icon"},[e("use",{"xlink:href":q})],-1)),Se=[Ie],Ve={key:1,class:"user"},Ce={class:"wrapper"},Pe={class:"user__text-wrapper"},Ae={class:"user__text"},Ne={class:"user__text-wrapper"},qe={class:"user__text"},Ee={class:"user__text-wrapper"},Re={class:"user__text"},Be={class:"user-rating-box"},De=m(()=>e("h3",null,"User rating",-1)),$e={__name:"UserPage",setup(v){const g=F(),E=j(),R=9,c=z(),p=x(parseInt(g.query.page)||1),u=M(),B=Z({position:"top"}),i=U({name:!1,phone:!1}),n=U({name:"",phone:""}),h=x({}),b=x(null);T(async()=>{const{id:a}=u;E.push({query:{...g.query,page:p.value}});const t=g.params.id;if(t){await c.fetchUserApartments(t,p.value);const{user:_,phone:f,email:s,userRating:D}=c.apartments[0].user,$=Math.round(D);h.value={user:_,phone:f,email:s,rating:$},b.value=t}else c.fetchUserApartments(a,p.value);if(n.name=u.name,u.phone){const _=P(u.phone);n.phone=_}});const k=a=>{if(a.target.name==="name"&&(n.name=a.target.value),a.target.name==="phone"){const t=a.target.value;/^\+38\(\d{3}\)\d{3}-\d{2}-\d{2}$/.test(t)&&(n.phone=a.target.value)}},w=async()=>{try{const a=O(n.phone),t=n.name,_={phone:a,name:t};await u.fetchUpdateUser(_),i.phone=!1,i.name=!1}catch(a){if(i.phone=!1,i.name=!1,a.request.status===400)return n.phone=u.phone,B.warning(a.request.response);console.log(a.message)}};return(a,t)=>{const _=I("URating"),f=I("ULoader");return o(),r("main",null,[e("section",null,[e("div",ee,[e("div",te,[e("div",se,[b.value?(o(),r("div",Ve,[e("div",Ce,[e("div",Pe,[e("p",Ae,"Name: "+d(h.value.user),1)]),e("div",Ne,[e("p",qe,"Email: "+d(h.value.email),1)]),e("div",Ee,[e("p",Re,"Phone: "+d(l(P)(h.value.phone)),1)])])])):(o(),r("div",ae,[e("div",ne,[i.name?(o(),r("div",_e,[e("label",le,[S(" і’мя: "),e("input",{class:"user__input-rename",name:"name",value:n.name,onChange:k},null,40,ue)]),e("button",{onClick:w,class:"btn-edit"},de)])):(o(),r("div",oe,[e("p",re,"і’мя: "+d(n.name),1),e("button",{onClick:t[0]||(t[0]=s=>i.name=!0),class:"btn-edit"},ie)]))]),e("div",he,[e("p",me,"E-mail: "+d(l(u).email),1)]),e("div",ve,[i.phone?(o(),r("div",ke,[e("label",we,[S(" Телефон: "),G(e("input",{ref:"phoneInput",class:"user__input-rename",type:"tel",name:"phone",value:n.phone,onChange:k},null,40,Ue),[[l(Q),{mask:"+38(0##)###-##-##"}]])]),e("button",{onClick:w,class:"btn-edit"},Se)])):(o(),r("div",ge,[n.phone?(o(),r("p",fe,"Телефон: "+d(n.phone),1)):(o(),r("p",xe,"Телефон: +38(000)000-00-00")),e("button",{onClick:t[1]||(t[1]=s=>i.phone=!0),class:"btn-edit"},be)]))])])),e("div",Be,[De,y(_,{width:50,height:50,rating:h.value.rating},null,8,["rating"])])]),e("div",null,[l(c).loading?(o(),V(f,{key:0,loading:!0})):C("",!0),y(J,{apartments:l(c).apartments},{apartment:H(s=>[y(W,{id:s.apartment._id,coverImage:s.apartment.coverImage,description:s.apartment.description,price:s.apartment.price,longStayPrice:s.apartment.longStayPrice,country:s.apartment.country,rating:s.apartment.rating},null,8,["id","coverImage","description","price","longStayPrice","country","rating"])]),_:1},8,["apartments"])])]),l(c).totalPosts>9&&!l(c).loading?(o(),V(K,{key:0,class:"paginate",modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=s=>p.value=s),perPage:R,rangeSize:1,"active-color":"#DCEDFF","onUpdate:value":t[3]||(t[3]=s=>p.value=s),totalPost:l(c).totalPosts},null,8,["modelValue","totalPost"])):C("",!0)])])])}}},Fe=L($e,[["__scopeId","data-v-fdbf911d"]]);export{Fe as default};
