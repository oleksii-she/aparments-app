import{_ as H,ac as j,a as z,b as g,q as S,o as r,d as o,f as e,F as q,z as J,V as K,a1 as E,B as l,v as b,a9 as T,c as P,t as Q,g as f,p as W,j as X,m as U,a8 as Y,n as Z,al as ee,am as se,e as d,D as i,an as V,h as k,x as M}from"./index-4ca0792c.js";import{B as te}from"./BackBtn-bed38f05.js";const re={class:"wrapper"},oe={class:"reserve-list"},ne=["onClick"],ae={class:"reserve__top"},de={class:"reserve__title"},ie={key:0},le={class:"reserve__description"},ce={__name:"reserveMessageList",props:{reserves:Array,handlerIdGet:{type:Function,default:()=>{}}},setup(t){const m=t,h=j(),s=z(),I=g(null);S(()=>{I.value=h.params.id});const c=n=>{const u=T(),a=T(n);return a.isSame(u,"day")?a.format("HH:mm:ss"):a.format("MM.DD")},p=n=>{m.handlerIdGet(n),s.push(`/myaccount/reserved/${n}`)};return(n,u)=>(r(),o("div",re,[e("ul",oe,[(r(!0),o(q,null,J(t.reserves,a=>(r(),o("li",{class:"reserve-list__item",key:a._id},[e("div",{class:E(["reserve",{"reserve-active":I.value===a._id}]),onClick:G=>p(a._id)},[e("div",ae,[e("p",de,l(a.name),1),e("p",null,l(c(a.updatedAt)),1)]),a.apartmentName?(r(),o("p",ie,l(a.apartmentName),1)):b("",!0),e("p",le,l(a.description),1)],10,ne)]))),128)),K(n.$slots,"default",{},void 0,!0)])]))}},D=H(ce,[["__scopeId","data-v-75f7927b"]]);const B=t=>(W("data-v-8fecbefd"),t=t(),X(),t),ve=U+"#icon-reserved",_e=U+"#icon-delete",ue={key:0,class:"wrapper-info"},fe={class:"header"},he={class:"info"},pe={class:"info__header-text"},me={class:"info__email-link",href:"mailto:{{ reserveInfo.email }}"},ge={class:"button-box"},Ie=B(()=>e("use",{"xlink:href":ve},null,-1)),ye=[Ie],be=B(()=>e("button",{type:"",class:"button"},[e("svg",{class:"button__icon"},[e("use",{"xlink:href":_e})])],-1)),ke=["src"],$e={class:"price-date"},xe={class:"price-date__text"},Re={class:"price-date__text"},we={class:"price-date__text"},Me={class:"price-date__text"},De={class:"description-box"},Se={class:"description-box__date"},Te={class:"description-box__description"},Ce={key:1,class:"wrapper-info-default"},Be=B(()=>e("div",null,[e("h2",null,"Select a message to read it")],-1)),Ge=[Be],Ae={__name:"reserveMessageInfo",props:{reserveInfo:Object,updateReserve:{type:Function,default:()=>{}}},setup(t){const m=t,h=g(null);S(async()=>{if(m.reserveInfo&&typeof m.reserveInfo.reserved<"u"){const c=m.reserveInfo.reserved;h.value=c}});const s=c=>{const p=T(),n=T(c);return n.isSame(p,"day")?n.format("HH:mm:ss"):n.format("MM.DD")},I=c=>{h.value=!0,m.updateReserve(c)};return(c,p)=>{const n=P("RouterLink");return t.reserveInfo?(r(),o("div",ue,[e("div",fe,[e("div",he,[e("p",pe,"Name: "+l(t.reserveInfo.name),1),e("a",me,l(t.reserveInfo.email),1)]),e("div",ge,[e("button",{type:"",class:"button",onClick:p[0]||(p[0]=u=>I(t.reserveInfo.apartmentId))},[(r(),o("svg",{class:E(["button__icon-reserved",{"button__icon-reserved---active":h.value}])},ye,2))]),be])]),e("div",null,[t.reserveInfo.apartmentId?(r(),Q(n,{key:0,to:{name:"review-page",params:{id:t.reserveInfo.apartmentId}},class:"wrapper-info__apartment-link"},{default:f(()=>[e("img",{src:t.reserveInfo.coverImage,alt:"",width:"64"},null,8,ke),e("p",null,l(t.reserveInfo.apartmentName),1)]),_:1},8,["to"])):b("",!0)]),e("div",null,[e("div",$e,[e("div",null,[e("p",xe,"sum: "+l(t.reserveInfo.sum)+"$",1),e("p",Re,"number of days: "+l(t.reserveInfo.numberOfDays),1)]),e("div",null,[e("p",we,"Start date: "+l(t.reserveInfo.startDate)+"$",1),e("p",Me,"End date: "+l(t.reserveInfo.endDate),1)])])]),e("div",De,[e("p",Se,l(s(t.reserveInfo.updatedAt)),1),e("p",Te,l(t.reserveInfo.description),1)])])):(r(),o("div",Ce,Ge))}}},F=H(Ae,[["__scopeId","data-v-8fecbefd"]]);const Le={class:"container"},Ne={key:0,class:"reserved-wrapper reserved-mobile"},Ve={key:0},Fe={key:0,class:"reserved-box"},He=e("h2",{style:{"text-align":"center","margin-bottom":"20px"}},"In reserve",-1),je={key:0},ze={key:1,class:"reserved-box"},Ee=e("h2",{style:{"text-align":"center","margin-bottom":"20px"}},"Reserved",-1),Pe={key:0},Ue={key:1,class:"reserved-wrapper__info"},Oe={key:1,class:"reserved-wrapper"},qe={key:0,class:"reserved-box"},Je=e("h2",null,"In reserve",-1),Ke={key:0},Qe={key:1,class:"reserved-box"},We=e("h2",null,"Reserved",-1),Xe={key:0},Ye={class:"reserved-wrapper__info"},ss={__name:"Reserved",setup(t){const m=j(),{id:h}=m.params,s=Y(),I=Z(),c=g(null),p=g(!1),n=g(1),u=g(!1),{isMobile:a}=ee(),G=g(null),C=g(!1);S(async()=>{await s.fetchGetAllReserve(),s.reserves.length!==s.totalReservePost&&await s.fetchGetAllReserve(n.value)});const O=z();S(async()=>{let v=c.value;v||(v=h),s.reserversIdInfo(v),s.reservesReserved.find(y=>y._id===h)&&(u.value=!0)});const $=()=>{p.value=!p.value},x=v=>{s.reserves<=9||v&&s.reserves.length!==s.totalReservePost&&(n.value=1)},R=v=>{c.value=v,s.reserversIdInfo(h),v&&(C.value=!0)},A=async v=>{try{const _=await I.updateApartmentReserved(v,{reserved:!0});G.value=_.reserved,await s.fetchGetAllReserve()}catch(_){console.log(_.message)}},L=()=>{C.value=!1,O.push("/myaccount/reserved")};return(v,_)=>{const y=P("UButton"),w=se("observe-visibility");return r(),o("div",Le,[d(V,{loading:i(s).loading},null,8,["loading"]),i(a)?(r(),o("div",Ne,[C.value?(r(),o("div",Ue,[d(te,{class:"button-back",onClick:L},{default:f(()=>[k("back")]),_:1}),d(F,{reserveInfo:i(s).reserveId,updateReserve:A},null,8,["reserveInfo"])])):(r(),o("div",Ve,[u.value?(r(),o("div",Fe,[d(y,{style:{width:"150px",height:"50px"},onClick:_[0]||(_[0]=N=>u.value=!1)},{default:f(()=>[k("Reserved")]),_:1}),He,d(D,{reserves:i(s).reservesReserved,hideModalToggle:$,handlerIdGet:R},{default:f(()=>[i(s).reserves.length?M((r(),o("div",je,null,512)),[[w,x]]):b("",!0)]),_:1},8,["reserves"])])):(r(),o("div",ze,[d(y,{style:{width:"150px",height:"50px"},onClick:_[1]||(_[1]=N=>u.value=!0)},{default:f(()=>[k("In reserve")]),_:1}),Ee,d(D,{reserves:i(s).reserves,hideModalToggle:$,handlerIdGet:R},{default:f(()=>[i(s).reserves.length?M((r(),o("div",Pe,null,512)),[[w,x]]):b("",!0)]),_:1},8,["reserves"])]))]))])):(r(),o("div",Oe,[u.value?(r(),o("div",qe,[d(y,{style:{width:"250px"},onClick:_[2]||(_[2]=N=>u.value=!1)},{default:f(()=>[k("Reserved")]),_:1}),Je,d(D,{reserves:i(s).reservesReserved,hideModalToggle:$,handlerIdGet:R},{default:f(()=>[i(s).reserves.length>9?M((r(),o("div",Ke,null,512)),[[w,x]]):b("",!0)]),_:1},8,["reserves"])])):(r(),o("div",Qe,[d(y,{style:{width:"250px"},onClick:L},{default:f(()=>[k("In reserve")]),_:1}),We,d(D,{reserves:i(s).reserves,hideModalToggle:$,handlerIdGet:R},{default:f(()=>[i(s).reserves.length>9?M((r(),o("div",Xe,null,512)),[[w,x]]):b("",!0)]),_:1},8,["reserves"])])),d(V,{loading:i(s).loading},null,8,["loading"]),e("div",Ye,[d(F,{reserveInfo:i(s).reserveId,updateReserve:A},null,8,["reserveInfo"])])]))])}}};export{ss as default};
