import{S as ie,C as le}from"./containerAuth-4e71f4ea.js";import{_ as re,u as ce,r as j,n as ue,b as de,d as I,q as pe,s as O,e as F,o as c,c as u,f as d,a as t,v as H,g,P as me,M as _e,x as f,y as ge,z as he,F as P,B as R,t as ve,m as W,h as fe,i as ye,C as be,D as Ve,p as ke,k as Ce,A as Ie,l as N}from"./index-6207669b.js";let S;const we=new Uint8Array(16);function Ue(){if(!S&&(S=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!S))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return S(we)}const l=[];for(let s=0;s<256;++s)l.push((s+256).toString(16).slice(1));function xe(s,n=0){return(l[s[n+0]]+l[s[n+1]]+l[s[n+2]]+l[s[n+3]]+"-"+l[s[n+4]]+l[s[n+5]]+"-"+l[s[n+6]]+l[s[n+7]]+"-"+l[s[n+8]]+l[s[n+9]]+"-"+l[s[n+10]]+l[s[n+11]]+l[s[n+12]]+l[s[n+13]]+l[s[n+14]]+l[s[n+15]]).toLowerCase()}const Pe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),q={randomUUID:Pe};function Se(s,n,e){if(q.randomUUID&&!n&&!s)return q.randomUUID();s=s||{};const v=s.random||(s.rng||Ue)();if(v[6]=v[6]&15|64,v[8]=v[8]&63|128,n){e=e||0;for(let y=0;y<16;++y)n[e+y]=v[y];return n}return xe(v)}const r=s=>(ke("data-v-34f1b32f"),s=s(),Ce(),s),z=N+"#icon-cancel-circle",Y=N+"#icon-create__img",De=N+"#icon-camera",Ae=["onSubmit"],Le=r(()=>t("h2",{class:"title__form-create"},"Create an ad",-1)),Be={class:"top__wrapper"},Fe=r(()=>t("p",{class:"title-input"},"The name of the ad",-1)),Re=r(()=>t("p",{class:"title-input"},"Country",-1)),Ne={key:0,class:"countries-list"},Me=["onClick"],Ee={class:"countries-list__text"},$e=r(()=>t("p",{class:"title-input"},"Місто",-1)),Te={class:"average__wrapper"},je={class:"main__photo"},Oe=r(()=>t("h3",{style:{marginBottom:"7px"}},"Main photo",-1)),He={for:"",class:"cover-img__wrapper"},We=r(()=>t("svg",{class:"clear-img__icon"},[t("use",{"xlink:href":z})],-1)),qe=[We],ze={class:"img__box"},Ye=["src"],Ge={key:1,class:"icon"},Je=r(()=>t("use",{"xlink:href":Y},null,-1)),Ke=[Je],Qe={class:"input-block__right"},Xe={class:"input-wrapper"},Ze=r(()=>t("p",{class:"title-input"},"Number of rooms",-1)),et=r(()=>t("p",{class:"title-input"},"Address",-1)),tt={class:"price"},st=r(()=>t("p",{class:"title-input"},"Price per night",-1)),ot={class:"price__wrapper"},at=r(()=>t("h2",{class:"price__title"},"$",-1)),nt={class:"price"},it=r(()=>t("p",{class:"title-input"},"Price from three nights",-1)),lt={class:"price__wrapper"},rt=r(()=>t("h2",{class:"price__title"},"$",-1)),ct=r(()=>t("p",{class:"title-input"},"Describe the apartments",-1)),ut=be('<div data-v-34f1b32f><p class="title-input" data-v-34f1b32f>Apartment class</p><select name="select" class="select" data-v-34f1b32f><option value="Economy" data-v-34f1b32f>Economy</option><option value="Comfort" selected data-v-34f1b32f>Comfort</option><option value="Business" data-v-34f1b32f>Business</option><option value="Premium" data-v-34f1b32f>Premium</option><option value="Lux" data-v-34f1b32f>Lux</option></select></div>',1),dt={class:"bottom-wrapper"},pt={key:0,for:"",class:"img__file-wrapper"},mt={key:0,class:"icon"},_t=r(()=>t("use",{"xlink:href":Y},null,-1)),gt=[_t],ht=r(()=>t("svg",{class:""},[t("use",{"xlink:href":De})],-1)),vt=[ht],ft=["src"],yt=["onClick"],bt=r(()=>t("svg",{class:"clear-img__icon"},[t("use",{"xlink:href":z})],-1)),Vt=[bt],kt={__name:"createPost",setup(s){const n=ce(),e=j({name:"",location:"",country:"",address:"",rooms:1,price:40,longStayPrice:30,description:"",images:[],coverImage:"",apartmentClass:""}),v=ue(),y=de(),D=Ie({position:"top"}),A=I(!1),V=I(null),w=I(!0),M=I(null),b=I(!1);pe(()=>{n.phone==="+380000000000"?b.value=!0:b.value=!1});const G=async()=>{try{const i=await Ve(e.country);!i||i===null?(w.value=!1,V.value=""):(w.value=!0,V.value=i)}catch(i){console.log(i.message)}},J=i=>{w.value=!1,e.country=i,V.value=null},E=["../assets/svg/sprite.svg#icon-cancel-circle","@/assets/svg/sprite.svg#icon-create__img","@/assets/svg/sprite.svg#icon-create__img","@/assets/svg/sprite.svg#icon-create__img","@/assets/svg/sprite.svg#icon-create__img"],L=j([...E]),K=O(()=>e.coverImage?URL.createObjectURL(e.coverImage):null),Q=O(()=>e.images?e.images.map(i=>{if(!(e.images.length>6))return{id:i.id,path:URL.createObjectURL(i.file),name:i.name}}):null),X=i=>{const o=i.target.files[0];o&&(e.coverImage=o)},Z=i=>{const o=i.target.files[0];new FormData().append("image",o),!(!o||e.images.length>5)&&o&&(L.splice(0,1),e.images.push({id:Se(),file:o}))},ee=()=>{e.coverImage&&(e.coverImage=null)},te=i=>{e.images=e.images.filter(o=>o.id!==i),e.images.length!==5&&L.push(E[0])},se=()=>{const i=M.value;i&&i.click()},oe=async i=>{const{name:o,location:k,country:m,address:U,rooms:a,price:C,longStayPrice:B,description:$,images:ne,coverImage:T}=e,x=ne.map(h=>h.file),_={coverImage:T,images:x,apartmentClass:i.target.select.value,name:o,location:k,country:m,address:U,rooms:Number(a),price:Number(C),longStayPrice:Number(B),description:$},p=new FormData;p.append("apartmentClass",_.apartmentClass);for(let h=0;h<x.length;h++)p.append("images",x[h],x[h].name);if(p.append("coverImage",_.coverImage),p.append("name",_.name),p.append("location",_.location),p.append("country",_.country),p.append("address",_.address),p.append("rooms",_.rooms),p.append("price",_.price),p.append("longStayPrice",_.longStayPrice),p.append("description",_.description),!o||!k||!m||!U||!a||!C||!B||!$||!T)return D.warning("Make sure all fields are filled");try{return A.value=!0,await v.addApartmentPost(p),A.value=!1,y.push({name:"apartments"}),D.success("data successfully added")}catch(h){return console.log(h.message),D.error(h.message)}},ae=()=>(y.push({name:"apartments"}),b.value=!b.value);return(i,o)=>{const k=F("ULoader"),m=F("UInput"),U=F("UButton");return c(),u(P,null,[d(k,{loading:A.value},null,8,["loading"]),t("form",{onSubmit:ye(oe,["prevent","stop"]),class:"form__advertisement"},[b.value?(c(),H(_e,{key:0,toggleModal:b.value,hideDialog:ae},{default:g(()=>[d(me)]),_:1},8,["toggleModal"])):f("",!0),Le,t("div",Be,[d(m,{modelValue:e.name,"onUpdate:modelValue":o[0]||(o[0]=a=>e.name=a),placeholder:"Назва оголошення",class:"uinput"},{default:g(()=>[Fe]),_:1},8,["modelValue"]),t("div",null,[d(m,{modelValue:e.country,"onUpdate:modelValue":o[1]||(o[1]=a=>e.country=a),placeholder:"Country",class:"uinput",onInput:G},{default:g(()=>[Re]),_:1},8,["modelValue"]),V.value!==null?ge((c(),u("ul",Ne,[(c(!0),u(P,null,R(V.value,(a,C)=>(c(),u("li",{key:C,class:"countries-list__item",onClick:B=>J(a.name.common)},[t("p",Ee,ve(a.name.common),1)],8,Me))),128))],512)),[[he,w.value]]):f("",!0)]),d(m,{modelValue:e.location,"onUpdate:modelValue":o[2]||(o[2]=a=>e.location=a),placeholder:"Місто",class:"uinput"},{default:g(()=>[$e]),_:1},8,["modelValue"])]),t("div",Te,[t("div",je,[Oe,t("label",He,[e.coverImage?(c(),u("button",{key:0,class:"clear-img",onClick:ee},qe)):f("",!0),t("div",ze,[e.coverImage?(c(),u("img",{key:0,src:W(K),alt:"",class:"image"},null,8,Ye)):f("",!0)]),e.coverImage?f("",!0):(c(),u("svg",Ge,Ke)),t("input",{type:"file",name:"coverImage",accept:"image/*",class:"input__file__hidden",multiple:"",onChange:X},null,32)])]),t("div",Qe,[t("div",Xe,[d(m,{modelValue:e.rooms,"onUpdate:modelValue":o[3]||(o[3]=a=>e.rooms=a),placeholder:"Кількість кімнат",class:"uinput",type:"number"},{default:g(()=>[Ze]),_:1},8,["modelValue"]),d(m,{modelValue:e.address,"onUpdate:modelValue":o[4]||(o[4]=a=>e.address=a),placeholder:"Адреса",class:"uinput"},{default:g(()=>[et]),_:1},8,["modelValue"]),t("div",tt,[st,t("div",ot,[at,d(m,{modelValue:e.price,"onUpdate:modelValue":o[5]||(o[5]=a=>e.price=a),placeholder:"Price per night",class:"uinput",type:"number"},null,8,["modelValue"])])]),t("div",nt,[it,t("div",lt,[rt,d(m,{modelValue:e.longStayPrice,"onUpdate:modelValue":o[6]||(o[6]=a=>e.longStayPrice=a),placeholder:"Price from three nights",class:"uinput",type:"number",style:{width:"70px"}},null,8,["modelValue"])])])]),d(m,{modelValue:e.description,"onUpdate:modelValue":o[7]||(o[7]=a=>e.description=a),placeholder:"Describe the apartments",type:"textarea",class:"uinput"},{default:g(()=>[ct]),_:1},8,["modelValue"]),ut])]),t("div",dt,[e.images.length!==6?(c(),u("label",pt,[e.images?(c(),u("svg",mt,gt)):f("",!0),t("input",{type:"file",name:"images",accept:"image/*",class:"input__file__hidden",onChange:Z,ref_key:"input",ref:M},null,544)])):f("",!0),(c(!0),u(P,null,R(L,a=>(c(),u("div",{key:a},[t("div",{class:"img__file-wrapper",onClick:se},vt)]))),128)),(c(!0),u(P,null,R(W(Q),a=>(c(),u("div",{key:a.id,class:"img__box"},[t("img",{src:a.path,alt:"",class:"images"},null,8,ft),t("button",{onClick:C=>te(a.id),class:"clear-img"},Vt,8,yt)]))),128))]),b.value?f("",!0):(c(),H(U,{key:1},{default:g(()=>[fe("Create an ad")]),_:1}))],40,Ae)],64)}}},Ct=re(kt,[["__scopeId","data-v-34f1b32f"]]),Ut={__name:"newPostPage",setup(s){return(n,e)=>(c(),u("main",null,[d(ie,null,{default:g(()=>[d(le,{class:"container"},{default:g(()=>[d(Ct)]),_:1})]),_:1})]))}};export{Ut as default};
